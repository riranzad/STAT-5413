<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 Fitting the model | Notes for STAT 5413 - Spatial Statistics</title>
  <meta name="description" content="These are the lecture notes for STAT 5413 Spatial Statistics" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="13 Fitting the model | Notes for STAT 5413 - Spatial Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are the lecture notes for STAT 5413 Spatial Statistics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 Fitting the model | Notes for STAT 5413 - Spatial Statistics" />
  
  <meta name="twitter:description" content="These are the lecture notes for STAT 5413 Spatial Statistics" />
  

<meta name="author" content="John Tipton" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="example-simple-linear-regression.html"/>
<link rel="next" href="day-12.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<script src="libs/elevate-section-attrs-2.0/elevate-section-attrs.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 5413 Spatial Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="day-1.html"><a href="day-1.html"><i class="fa fa-check"></i><b>1</b> Day 1</a>
<ul>
<li class="chapter" data-level="1.1" data-path="day-1.html"><a href="day-1.html#notation"><i class="fa fa-check"></i><b>1.1</b> Notation</a></li>
<li class="chapter" data-level="1.2" data-path="day-1.html"><a href="day-1.html#probability-distributions"><i class="fa fa-check"></i><b>1.2</b> Probability Distributions</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="day-1.html"><a href="day-1.html#example-linear-regression"><i class="fa fa-check"></i><b>1.2.1</b> Example: linear regression</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="day-1.html"><a href="day-1.html#hierarchical-modeling"><i class="fa fa-check"></i><b>1.3</b> Hierarchical modeling</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="day-1.html"><a href="day-1.html#bayesian-hierarchical-models-bhms"><i class="fa fa-check"></i><b>1.3.1</b> Bayesian Hierarchical models (BHMs)</a></li>
<li class="chapter" data-level="1.3.2" data-path="day-1.html"><a href="day-1.html#empirical-hierarchical-models-ehms"><i class="fa fa-check"></i><b>1.3.2</b> Empirical Hierarchical models (EHMs)</a></li>
<li class="chapter" data-level="1.3.3" data-path="day-1.html"><a href="day-1.html#data-model"><i class="fa fa-check"></i><b>1.3.3</b> Data Model</a></li>
<li class="chapter" data-level="1.3.4" data-path="day-1.html"><a href="day-1.html#process-model"><i class="fa fa-check"></i><b>1.3.4</b> Process Model</a></li>
<li class="chapter" data-level="1.3.5" data-path="day-1.html"><a href="day-1.html#parameter-prior-model-bmhs-only"><i class="fa fa-check"></i><b>1.3.5</b> Parameter (Prior) Model (BMHs only)</a></li>
<li class="chapter" data-level="1.3.6" data-path="day-1.html"><a href="day-1.html#posterior-distribution"><i class="fa fa-check"></i><b>1.3.6</b> Posterior Distribution</a></li>
<li class="chapter" data-level="1.3.7" data-path="day-1.html"><a href="day-1.html#scientifically-motivated-statistical-modeling"><i class="fa fa-check"></i><b>1.3.7</b> Scientifically Motivated Statistical Modeling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="day-2.html"><a href="day-2.html"><i class="fa fa-check"></i><b>2</b> Day 2</a>
<ul>
<li class="chapter" data-level="2.1" data-path="day-2.html"><a href="day-2.html#spatial-data"><i class="fa fa-check"></i><b>2.1</b> Spatial Data</a></li>
<li class="chapter" data-level="2.2" data-path="day-2.html"><a href="day-2.html#types-of-spatial-data"><i class="fa fa-check"></i><b>2.2</b> Types of spatial data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="day-2.html"><a href="day-2.html#geostatistical-data"><i class="fa fa-check"></i><b>2.2.1</b> Geostatistical data</a></li>
<li class="chapter" data-level="2.2.2" data-path="day-2.html"><a href="day-2.html#areal-data"><i class="fa fa-check"></i><b>2.2.2</b> Areal data</a></li>
<li class="chapter" data-level="2.2.3" data-path="day-2.html"><a href="day-2.html#point-process-data"><i class="fa fa-check"></i><b>2.2.3</b> Point process data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="day-3.html"><a href="day-3.html"><i class="fa fa-check"></i><b>3</b> Day 3</a>
<ul>
<li class="chapter" data-level="3.1" data-path="day-3.html"><a href="day-3.html#anouncements"><i class="fa fa-check"></i><b>3.1</b> Anouncements</a></li>
<li class="chapter" data-level="3.2" data-path="day-3.html"><a href="day-3.html#files-for-spatial-data"><i class="fa fa-check"></i><b>3.2</b> Files for spatial data</a></li>
<li class="chapter" data-level="3.3" data-path="day-3.html"><a href="day-3.html#textbook-package"><i class="fa fa-check"></i><b>3.3</b> Textbook package</a></li>
<li class="chapter" data-level="3.4" data-path="day-3.html"><a href="day-3.html#spatial-visualization"><i class="fa fa-check"></i><b>3.4</b> Spatial Visualization</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="day-3.html"><a href="day-3.html#spatial-visualization-using-fields"><i class="fa fa-check"></i><b>3.4.1</b> Spatial visualization using <em>fields</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="day-4.html"><a href="day-4.html"><i class="fa fa-check"></i><b>4</b> Day 4</a>
<ul>
<li class="chapter" data-level="4.1" data-path="day-4.html"><a href="day-4.html#announcements"><i class="fa fa-check"></i><b>4.1</b> Announcements</a></li>
<li class="chapter" data-level="4.2" data-path="day-4.html"><a href="day-4.html#visualization-continued"><i class="fa fa-check"></i><b>4.2</b> Visualization (continued)</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="day-4.html"><a href="day-4.html#spatial-visualization-using-fields-1"><i class="fa fa-check"></i><b>4.2.1</b> Spatial visualization using <em>fields</em></a></li>
<li class="chapter" data-level="4.2.2" data-path="day-4.html"><a href="day-4.html#in-class-activity"><i class="fa fa-check"></i><b>4.2.2</b> In Class Activity:</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="day-4.html"><a href="day-4.html#interactive-visualization-interactive-with-html-format-only"><i class="fa fa-check"></i><b>4.3</b> Interactive visualization (Interactive with HTML format only)</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="day-4.html"><a href="day-4.html#interactive-display-of-data"><i class="fa fa-check"></i><b>4.3.1</b> Interactive display of data</a></li>
<li class="chapter" data-level="4.3.2" data-path="day-4.html"><a href="day-4.html#animations"><i class="fa fa-check"></i><b>4.3.2</b> Animations</a></li>
<li class="chapter" data-level="4.3.3" data-path="day-4.html"><a href="day-4.html#interactive-plotting-using-plotly"><i class="fa fa-check"></i><b>4.3.3</b> Interactive plotting using <em>plotly</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="day-5.html"><a href="day-5.html"><i class="fa fa-check"></i><b>5</b> Day 5</a>
<ul>
<li class="chapter" data-level="5.1" data-path="day-5.html"><a href="day-5.html#announcements-1"><i class="fa fa-check"></i><b>5.1</b> Announcements</a></li>
<li class="chapter" data-level="5.2" data-path="day-5.html"><a href="day-5.html#spatial-means-and-covariances"><i class="fa fa-check"></i><b>5.2</b> Spatial means and covariances</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="day-5.html"><a href="day-5.html#gaussian-processes"><i class="fa fa-check"></i><b>5.2.1</b> Gaussian processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="day-6.html"><a href="day-6.html"><i class="fa fa-check"></i><b>6</b> Day 6</a>
<ul>
<li class="chapter" data-level="6.1" data-path="day-6.html"><a href="day-6.html#announcements-2"><i class="fa fa-check"></i><b>6.1</b> Announcements</a></li>
<li class="chapter" data-level="6.2" data-path="day-6.html"><a href="day-6.html#gaussian-process-assumptions"><i class="fa fa-check"></i><b>6.2</b> Gaussian process assumptions</a></li>
<li class="chapter" data-level="6.3" data-path="day-6.html"><a href="day-6.html#recall-hierachical-modeling"><i class="fa fa-check"></i><b>6.3</b> Recall Hierachical modeling</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="day-6.html"><a href="day-6.html#data-model-1"><i class="fa fa-check"></i><b>6.3.1</b> Data Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="day-7.html"><a href="day-7.html"><i class="fa fa-check"></i><b>7</b> Day 7</a>
<ul>
<li class="chapter" data-level="7.1" data-path="day-7.html"><a href="day-7.html#common-isotropic-correlation-functions"><i class="fa fa-check"></i><b>7.1</b> Common isotropic correlation functions</a></li>
<li class="chapter" data-level="7.2" data-path="day-7.html"><a href="day-7.html#covariograms-and-semivariograms"><i class="fa fa-check"></i><b>7.2</b> Covariograms and semivariograms</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="day-7.html"><a href="day-7.html#semivariograms-and-variograms"><i class="fa fa-check"></i><b>7.2.1</b> Semivariograms and variograms</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="day-8.html"><a href="day-8.html"><i class="fa fa-check"></i><b>8</b> Day 8</a>
<ul>
<li class="chapter" data-level="8.1" data-path="day-8.html"><a href="day-8.html#announcements-3"><i class="fa fa-check"></i><b>8.1</b> Announcements</a></li>
<li class="chapter" data-level="8.2" data-path="day-8.html"><a href="day-8.html#estimation-of-the-spatial-process"><i class="fa fa-check"></i><b>8.2</b> Estimation of the spatial process</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="day-8.html"><a href="day-8.html#estimation-of-the-spatial-process-using-variograms"><i class="fa fa-check"></i><b>8.2.1</b> Estimation of the spatial process using variograms</a></li>
<li class="chapter" data-level="8.2.2" data-path="day-8.html"><a href="day-8.html#maximum-likelihood"><i class="fa fa-check"></i><b>8.2.2</b> Maximum Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="day-8.html"><a href="day-8.html#maximum-likelihood-1"><i class="fa fa-check"></i><b>8.3</b> Maximum likelihood</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="day-9.html"><a href="day-9.html"><i class="fa fa-check"></i><b>9</b> Day 9</a>
<ul>
<li class="chapter" data-level="9.1" data-path="day-9.html"><a href="day-9.html#announcements-4"><i class="fa fa-check"></i><b>9.1</b> Announcements</a></li>
<li class="chapter" data-level="9.2" data-path="day-9.html"><a href="day-9.html#asymptotic-properties-of-the-mle"><i class="fa fa-check"></i><b>9.2</b> Asymptotic properties of the MLE</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="day-10.html"><a href="day-10.html"><i class="fa fa-check"></i><b>10</b> Day 10</a>
<ul>
<li class="chapter" data-level="10.1" data-path="day-10.html"><a href="day-10.html#announcements-5"><i class="fa fa-check"></i><b>10.1</b> Announcements</a></li>
<li class="chapter" data-level="10.2" data-path="day-10.html"><a href="day-10.html#asymptotic-properties-of-the-mle-1"><i class="fa fa-check"></i><b>10.2</b> Asymptotic properties of the MLE</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="day-11.html"><a href="day-11.html"><i class="fa fa-check"></i><b>11</b> Day 11</a>
<ul>
<li class="chapter" data-level="11.1" data-path="day-11.html"><a href="day-11.html#announcements-6"><i class="fa fa-check"></i><b>11.1</b> Announcements</a></li>
<li class="chapter" data-level="11.2" data-path="day-11.html"><a href="day-11.html#introduction-to-mcmc"><i class="fa fa-check"></i><b>11.2</b> Introduction to MCMC</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="example-simple-linear-regression.html"><a href="example-simple-linear-regression.html"><i class="fa fa-check"></i><b>12</b> Example: Simple linear regression</a>
<ul>
<li class="chapter" data-level="12.1" data-path="example-simple-linear-regression.html"><a href="example-simple-linear-regression.html#the-posterior-distribution"><i class="fa fa-check"></i><b>12.1</b> The posterior distribution</a></li>
<li class="chapter" data-level="12.2" data-path="example-simple-linear-regression.html"><a href="example-simple-linear-regression.html#marginal-posterior-of-mu"><i class="fa fa-check"></i><b>12.2</b> Marginal posterior of <span class="math inline">\(\mu\)</span></a></li>
<li class="chapter" data-level="12.3" data-path="example-simple-linear-regression.html"><a href="example-simple-linear-regression.html#marginal-posterior-of-beta"><i class="fa fa-check"></i><b>12.3</b> Marginal posterior of <span class="math inline">\(\beta\)</span></a></li>
<li class="chapter" data-level="12.4" data-path="example-simple-linear-regression.html"><a href="example-simple-linear-regression.html#marginal-posterior-of-sigma2"><i class="fa fa-check"></i><b>12.4</b> Marginal posterior of <span class="math inline">\(\sigma^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="fitting-the-model.html"><a href="fitting-the-model.html"><i class="fa fa-check"></i><b>13</b> Fitting the model</a>
<ul>
<li class="chapter" data-level="13.0.1" data-path="fitting-the-model.html"><a href="fitting-the-model.html#general-recommendations-for-writing-mcmc-software"><i class="fa fa-check"></i><b>13.0.1</b> General recommendations for writing MCMC software</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="day-12.html"><a href="day-12.html"><i class="fa fa-check"></i><b>14</b> Day 12</a>
<ul>
<li class="chapter" data-level="14.1" data-path="day-12.html"><a href="day-12.html#announcements-7"><i class="fa fa-check"></i><b>14.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="day-13.html"><a href="day-13.html"><i class="fa fa-check"></i><b>15</b> Day 13</a>
<ul>
<li class="chapter" data-level="15.1" data-path="day-13.html"><a href="day-13.html#announcements-8"><i class="fa fa-check"></i><b>15.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="day-14.html"><a href="day-14.html"><i class="fa fa-check"></i><b>16</b> Day 14</a>
<ul>
<li class="chapter" data-level="16.1" data-path="day-14.html"><a href="day-14.html#announcements-9"><i class="fa fa-check"></i><b>16.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="day-15.html"><a href="day-15.html"><i class="fa fa-check"></i><b>17</b> Day 15</a>
<ul>
<li class="chapter" data-level="17.1" data-path="day-15.html"><a href="day-15.html#announcements-10"><i class="fa fa-check"></i><b>17.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="day-16.html"><a href="day-16.html"><i class="fa fa-check"></i><b>18</b> Day 16</a>
<ul>
<li class="chapter" data-level="18.1" data-path="day-16.html"><a href="day-16.html#announcements-11"><i class="fa fa-check"></i><b>18.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="day-17.html"><a href="day-17.html"><i class="fa fa-check"></i><b>19</b> Day 17</a>
<ul>
<li class="chapter" data-level="19.1" data-path="day-17.html"><a href="day-17.html#announcements-12"><i class="fa fa-check"></i><b>19.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="day-18.html"><a href="day-18.html"><i class="fa fa-check"></i><b>20</b> Day 18</a>
<ul>
<li class="chapter" data-level="20.1" data-path="day-18.html"><a href="day-18.html#announcements-13"><i class="fa fa-check"></i><b>20.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="day-19.html"><a href="day-19.html"><i class="fa fa-check"></i><b>21</b> Day 19</a>
<ul>
<li class="chapter" data-level="21.1" data-path="day-19.html"><a href="day-19.html#announcements-14"><i class="fa fa-check"></i><b>21.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="day-20.html"><a href="day-20.html"><i class="fa fa-check"></i><b>22</b> Day 20</a>
<ul>
<li class="chapter" data-level="22.1" data-path="day-20.html"><a href="day-20.html#announcements-15"><i class="fa fa-check"></i><b>22.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="day-21.html"><a href="day-21.html"><i class="fa fa-check"></i><b>23</b> Day 21</a>
<ul>
<li class="chapter" data-level="23.1" data-path="day-21.html"><a href="day-21.html#announcements-16"><i class="fa fa-check"></i><b>23.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="day-22.html"><a href="day-22.html"><i class="fa fa-check"></i><b>24</b> Day 22</a>
<ul>
<li class="chapter" data-level="24.1" data-path="day-22.html"><a href="day-22.html#announcements-17"><i class="fa fa-check"></i><b>24.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="day-23.html"><a href="day-23.html"><i class="fa fa-check"></i><b>25</b> Day 23</a>
<ul>
<li class="chapter" data-level="25.1" data-path="day-23.html"><a href="day-23.html#announcements-18"><i class="fa fa-check"></i><b>25.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="day-24.html"><a href="day-24.html"><i class="fa fa-check"></i><b>26</b> Day 24</a>
<ul>
<li class="chapter" data-level="26.1" data-path="day-24.html"><a href="day-24.html#announcements-19"><i class="fa fa-check"></i><b>26.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="day-25.html"><a href="day-25.html"><i class="fa fa-check"></i><b>27</b> Day 25</a>
<ul>
<li class="chapter" data-level="27.1" data-path="day-25.html"><a href="day-25.html#announcements-20"><i class="fa fa-check"></i><b>27.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="day-26.html"><a href="day-26.html"><i class="fa fa-check"></i><b>28</b> Day 26</a>
<ul>
<li class="chapter" data-level="28.1" data-path="day-26.html"><a href="day-26.html#announcements-21"><i class="fa fa-check"></i><b>28.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="day-27.html"><a href="day-27.html"><i class="fa fa-check"></i><b>29</b> Day 27</a>
<ul>
<li class="chapter" data-level="29.1" data-path="day-27.html"><a href="day-27.html#announcements-22"><i class="fa fa-check"></i><b>29.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="30" data-path="day-28.html"><a href="day-28.html"><i class="fa fa-check"></i><b>30</b> Day 28</a>
<ul>
<li class="chapter" data-level="30.1" data-path="day-28.html"><a href="day-28.html#announcements-23"><i class="fa fa-check"></i><b>30.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="day-29.html"><a href="day-29.html"><i class="fa fa-check"></i><b>31</b> Day 29</a>
<ul>
<li class="chapter" data-level="31.1" data-path="day-29.html"><a href="day-29.html#announcements-24"><i class="fa fa-check"></i><b>31.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="day-30.html"><a href="day-30.html"><i class="fa fa-check"></i><b>32</b> Day 30</a>
<ul>
<li class="chapter" data-level="32.1" data-path="day-30.html"><a href="day-30.html#announcements-25"><i class="fa fa-check"></i><b>32.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="day-31.html"><a href="day-31.html"><i class="fa fa-check"></i><b>33</b> Day 31</a>
<ul>
<li class="chapter" data-level="33.1" data-path="day-31.html"><a href="day-31.html#announcements-26"><i class="fa fa-check"></i><b>33.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="day-32.html"><a href="day-32.html"><i class="fa fa-check"></i><b>34</b> Day 32</a>
<ul>
<li class="chapter" data-level="34.1" data-path="day-32.html"><a href="day-32.html#announcements-27"><i class="fa fa-check"></i><b>34.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="35" data-path="day-33.html"><a href="day-33.html"><i class="fa fa-check"></i><b>35</b> Day 33</a>
<ul>
<li class="chapter" data-level="35.1" data-path="day-33.html"><a href="day-33.html#announcements-28"><i class="fa fa-check"></i><b>35.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="day-34.html"><a href="day-34.html"><i class="fa fa-check"></i><b>36</b> Day 34</a>
<ul>
<li class="chapter" data-level="36.1" data-path="day-34.html"><a href="day-34.html#announcements-29"><i class="fa fa-check"></i><b>36.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="37" data-path="day-35.html"><a href="day-35.html"><i class="fa fa-check"></i><b>37</b> Day 35</a>
<ul>
<li class="chapter" data-level="37.1" data-path="day-35.html"><a href="day-35.html#announcements-30"><i class="fa fa-check"></i><b>37.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="day-36.html"><a href="day-36.html"><i class="fa fa-check"></i><b>38</b> Day 36</a>
<ul>
<li class="chapter" data-level="38.1" data-path="day-36.html"><a href="day-36.html#announcements-31"><i class="fa fa-check"></i><b>38.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="day-37.html"><a href="day-37.html"><i class="fa fa-check"></i><b>39</b> Day 37</a>
<ul>
<li class="chapter" data-level="39.1" data-path="day-37.html"><a href="day-37.html#announcements-32"><i class="fa fa-check"></i><b>39.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="day-38.html"><a href="day-38.html"><i class="fa fa-check"></i><b>40</b> Day 38</a>
<ul>
<li class="chapter" data-level="40.1" data-path="day-38.html"><a href="day-38.html#announcements-33"><i class="fa fa-check"></i><b>40.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="day-39.html"><a href="day-39.html"><i class="fa fa-check"></i><b>41</b> Day 39</a>
<ul>
<li class="chapter" data-level="41.1" data-path="day-39.html"><a href="day-39.html#announcements-34"><i class="fa fa-check"></i><b>41.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="day-40.html"><a href="day-40.html"><i class="fa fa-check"></i><b>42</b> Day 40</a>
<ul>
<li class="chapter" data-level="42.1" data-path="day-40.html"><a href="day-40.html#announcements-35"><i class="fa fa-check"></i><b>42.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="43" data-path="day-41.html"><a href="day-41.html"><i class="fa fa-check"></i><b>43</b> Day 41</a>
<ul>
<li class="chapter" data-level="43.1" data-path="day-41.html"><a href="day-41.html#announcements-36"><i class="fa fa-check"></i><b>43.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="44" data-path="day-42.html"><a href="day-42.html"><i class="fa fa-check"></i><b>44</b> Day 42</a>
<ul>
<li class="chapter" data-level="44.1" data-path="day-42.html"><a href="day-42.html#announcements-37"><i class="fa fa-check"></i><b>44.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="45" data-path="day-43.html"><a href="day-43.html"><i class="fa fa-check"></i><b>45</b> Day 43</a>
<ul>
<li class="chapter" data-level="45.1" data-path="day-43.html"><a href="day-43.html#announcements-38"><i class="fa fa-check"></i><b>45.1</b> Announcements</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notes for STAT 5413 - Spatial Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="fitting-the-model" class="section level1" number="13">
<h1 number="13"><span class="header-section-number">13</span> Fitting the model</h1>
<p>To estimate parameters from the regression model, we will consider the <em>iris</em> dataset and let <span class="math inline">\(y\)</span> be the <em>Petal.Width</em> variable and <span class="math inline">\(x\)</span> be the <em>Petal.Length</em> variable in <em>R</em>. The data with the fitted regression line using the <em>lm</em> function is shown below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="fitting-the-model.html#cb1-1"></a><span class="kw">data</span>(iris)</span>
<span id="cb1-2"><a href="fitting-the-model.html#cb1-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="fitting-the-model.html#cb1-3"></a><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x=</span>Petal.Length, <span class="dt">y=</span>Petal.Width)) <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>) <span class="op">+</span></span>
<span id="cb1-4"><a href="fitting-the-model.html#cb1-4"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="STAT-5413_files/figure-html/unnamed-chunk-1-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>To start, we setup the variables and define default values for the prior constants.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="fitting-the-model.html#cb2-1"></a>y &lt;-<span class="st"> </span>iris<span class="op">$</span>Petal.Width</span>
<span id="cb2-2"><a href="fitting-the-model.html#cb2-2"></a>x &lt;-<span class="st"> </span>iris<span class="op">$</span>Petal.Length</span>
<span id="cb2-3"><a href="fitting-the-model.html#cb2-3"></a><span class="co">## these are the prior choices. </span></span>
<span id="cb2-4"><a href="fitting-the-model.html#cb2-4"></a><span class="co">## We will talk later about how to choose prior distributions and values later</span></span>
<span id="cb2-5"><a href="fitting-the-model.html#cb2-5"></a>mu_mu &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb2-6"><a href="fitting-the-model.html#cb2-6"></a>sigma2_mu &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb2-7"><a href="fitting-the-model.html#cb2-7"></a>mu_beta &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb2-8"><a href="fitting-the-model.html#cb2-8"></a>sigma2_beta &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb2-9"><a href="fitting-the-model.html#cb2-9"></a>alpha_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="fl">0.01</span></span>
<span id="cb2-10"><a href="fitting-the-model.html#cb2-10"></a>beta_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="fl">0.01</span></span></code></pre></div>
<p>Next, we define empty vectors to store the MCMC output. We will run the MCMC sampler for <span class="math inline">\(K=5000\)</span> iterations.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="fitting-the-model.html#cb3-1"></a>K &lt;-<span class="st"> </span><span class="dv">5000</span></span>
<span id="cb3-2"><a href="fitting-the-model.html#cb3-2"></a>mu &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, K)</span>
<span id="cb3-3"><a href="fitting-the-model.html#cb3-3"></a>beta &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, K)</span>
<span id="cb3-4"><a href="fitting-the-model.html#cb3-4"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, K)</span></code></pre></div>
<p>The MCMC algorithm works by cycling through the marginal posterior distributions. The algorithm is called a Gibbs Sampler and we sample from

in sequential order.</p>
<p>In <em>R</em>, the Gibbs sampler is</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="fitting-the-model.html#cb4-1"></a><span class="kw">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb4-2"><a href="fitting-the-model.html#cb4-2"></a><span class="co">## initialize </span></span>
<span id="cb4-3"><a href="fitting-the-model.html#cb4-3"></a>mu[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, mu_mu, <span class="kw">sqrt</span>(sigma2_mu))</span>
<span id="cb4-4"><a href="fitting-the-model.html#cb4-4"></a>beta[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, mu_beta, <span class="kw">sqrt</span>(sigma2_beta))</span>
<span id="cb4-5"><a href="fitting-the-model.html#cb4-5"></a><span class="co">## note that sampling from an inverse gamma is the same as </span></span>
<span id="cb4-6"><a href="fitting-the-model.html#cb4-6"></a><span class="co">## the inverse of a random gamma variable</span></span>
<span id="cb4-7"><a href="fitting-the-model.html#cb4-7"></a>sigma2[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">1</span>, alpha_<span class="dv">0</span>, beta_<span class="dv">0</span>)</span>
<span id="cb4-8"><a href="fitting-the-model.html#cb4-8"></a></span>
<span id="cb4-9"><a href="fitting-the-model.html#cb4-9"></a><span class="co">## calculate the sample size</span></span>
<span id="cb4-10"><a href="fitting-the-model.html#cb4-10"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(y)</span>
<span id="cb4-11"><a href="fitting-the-model.html#cb4-11"></a></span>
<span id="cb4-12"><a href="fitting-the-model.html#cb4-12"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>K) {</span>
<span id="cb4-13"><a href="fitting-the-model.html#cb4-13"></a>  </span>
<span id="cb4-14"><a href="fitting-the-model.html#cb4-14"></a>  <span class="co">## sample mu</span></span>
<span id="cb4-15"><a href="fitting-the-model.html#cb4-15"></a>  a_mu &lt;-<span class="st"> </span>N <span class="op">/</span><span class="st"> </span>sigma2[k<span class="dv">-1</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>sigma2_mu</span>
<span id="cb4-16"><a href="fitting-the-model.html#cb4-16"></a>  b_mu &lt;-<span class="st"> </span><span class="kw">sum</span>(y <span class="op">-</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>beta[k<span class="dv">-1</span>]) <span class="op">/</span><span class="st"> </span>sigma2[k<span class="dv">-1</span>] <span class="op">+</span><span class="st"> </span>mu_mu <span class="op">/</span><span class="st"> </span>sigma2_mu</span>
<span id="cb4-17"><a href="fitting-the-model.html#cb4-17"></a>  mu[k] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, b_mu <span class="op">/</span><span class="st"> </span>a_mu, <span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>a_mu))</span>
<span id="cb4-18"><a href="fitting-the-model.html#cb4-18"></a>  </span>
<span id="cb4-19"><a href="fitting-the-model.html#cb4-19"></a>  <span class="co">## sample beta</span></span>
<span id="cb4-20"><a href="fitting-the-model.html#cb4-20"></a>  a_beta &lt;-<span class="st"> </span><span class="kw">sum</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>sigma2[k<span class="dv">-1</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>sigma2_beta</span>
<span id="cb4-21"><a href="fitting-the-model.html#cb4-21"></a>  b_beta &lt;-<span class="st"> </span><span class="kw">sum</span>(x<span class="op">*</span>(y <span class="op">-</span><span class="st"> </span>mu[k])) <span class="op">/</span><span class="st"> </span>sigma2[k<span class="dv">-1</span>] <span class="op">+</span><span class="st"> </span>mu_beta <span class="op">/</span><span class="st"> </span>sigma2_beta</span>
<span id="cb4-22"><a href="fitting-the-model.html#cb4-22"></a>  beta[k] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, b_beta <span class="op">/</span><span class="st"> </span>a_beta, <span class="kw">sqrt</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>a_beta))</span>
<span id="cb4-23"><a href="fitting-the-model.html#cb4-23"></a>  </span>
<span id="cb4-24"><a href="fitting-the-model.html#cb4-24"></a>  <span class="co">## sample sigma2</span></span>
<span id="cb4-25"><a href="fitting-the-model.html#cb4-25"></a>  sigma2[k] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">rgamma</span>(<span class="dv">1</span>, alpha_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>N<span class="op">/</span><span class="dv">2</span>, </span>
<span id="cb4-26"><a href="fitting-the-model.html#cb4-26"></a>                          beta_<span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>((y <span class="op">-</span><span class="st"> </span>(mu[k] <span class="op">+</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span>beta[k]))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb4-27"><a href="fitting-the-model.html#cb4-27"></a>}</span></code></pre></div>
<p>To visualize the MCMC samples, we can plot what are called trace plots</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="fitting-the-model.html#cb5-1"></a>samples &lt;-<span class="st"> </span><span class="kw">c</span>(mu, beta, sigma2)</span>
<span id="cb5-2"><a href="fitting-the-model.html#cb5-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb5-3"><a href="fitting-the-model.html#cb5-3"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb5-4"><a href="fitting-the-model.html#cb5-4"></a>  <span class="dt">sample =</span> <span class="dv">1</span><span class="op">:</span>K,</span>
<span id="cb5-5"><a href="fitting-the-model.html#cb5-5"></a>  <span class="dt">params =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;mu&quot;</span>, K), <span class="kw">rep</span>(<span class="st">&quot;beta&quot;</span>, K), <span class="kw">rep</span>(<span class="st">&quot;sigma2&quot;</span>, K))),</span>
<span id="cb5-6"><a href="fitting-the-model.html#cb5-6"></a>  <span class="dt">values =</span> samples)</span>
<span id="cb5-7"><a href="fitting-the-model.html#cb5-7"></a></span>
<span id="cb5-8"><a href="fitting-the-model.html#cb5-8"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>sample, <span class="dt">y=</span>values, <span class="dt">group=</span>params)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-9"><a href="fitting-the-model.html#cb5-9"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>params, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span>, <span class="dt">ncol=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="STAT-5413_files/figure-html/unnamed-chunk-5-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>The plotting window is strongly influenced by the initial condition. Instead, we can throw away the first 1000 samples (called burn-in) and examine the remaining 4000 samples for each parameter.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="fitting-the-model.html#cb6-1"></a>burnin &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb6-2"><a href="fitting-the-model.html#cb6-2"></a><span class="co">## subset the samples to only post-burnin</span></span>
<span id="cb6-3"><a href="fitting-the-model.html#cb6-3"></a>samples &lt;-<span class="st"> </span><span class="kw">cbind</span>(mu[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>burnin)], beta[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>burnin)], sigma2[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>burnin)])</span>
<span id="cb6-4"><a href="fitting-the-model.html#cb6-4"></a><span class="kw">colnames</span>(samples) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma2&quot;</span>)</span>
<span id="cb6-5"><a href="fitting-the-model.html#cb6-5"></a></span>
<span id="cb6-6"><a href="fitting-the-model.html#cb6-6"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb6-7"><a href="fitting-the-model.html#cb6-7"></a>  <span class="dt">sample =</span> (burnin<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>K,</span>
<span id="cb6-8"><a href="fitting-the-model.html#cb6-8"></a>  <span class="dt">params =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;mu&quot;</span>, K<span class="op">-</span>burnin), <span class="kw">rep</span>(<span class="st">&quot;beta&quot;</span>, K<span class="op">-</span>burnin),</span>
<span id="cb6-9"><a href="fitting-the-model.html#cb6-9"></a>                    <span class="kw">rep</span>(<span class="st">&quot;sigma2&quot;</span>, K<span class="op">-</span>burnin))),</span>
<span id="cb6-10"><a href="fitting-the-model.html#cb6-10"></a>  <span class="dt">values =</span> <span class="kw">c</span>(samples))</span>
<span id="cb6-11"><a href="fitting-the-model.html#cb6-11"></a></span>
<span id="cb6-12"><a href="fitting-the-model.html#cb6-12"></a><span class="co">## fit the linear model using the MLE</span></span>
<span id="cb6-13"><a href="fitting-the-model.html#cb6-13"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x)</span>
<span id="cb6-14"><a href="fitting-the-model.html#cb6-14"></a>df_lm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb6-15"><a href="fitting-the-model.html#cb6-15"></a>  <span class="dt">params =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;beta&quot;</span>, <span class="st">&quot;sigma2&quot;</span>)),</span>
<span id="cb6-16"><a href="fitting-the-model.html#cb6-16"></a>  <span class="dt">values =</span> <span class="kw">c</span>(fit<span class="op">$</span>coefficients[<span class="dv">1</span>], fit<span class="op">$</span>coefficients[<span class="dv">2</span>], <span class="kw">summary</span>(fit)<span class="op">$</span>sigma<span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb6-17"><a href="fitting-the-model.html#cb6-17"></a>  <span class="dt">row.names =</span> <span class="ot">NULL</span>)</span>
<span id="cb6-18"><a href="fitting-the-model.html#cb6-18"></a></span>
<span id="cb6-19"><a href="fitting-the-model.html#cb6-19"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>sample, <span class="dt">y=</span>values, <span class="dt">group=</span>params)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-20"><a href="fitting-the-model.html#cb6-20"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>params, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span>, <span class="dt">ncol=</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb6-21"><a href="fitting-the-model.html#cb6-21"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">data=</span>df_lm, <span class="kw">aes</span>(<span class="dt">yintercept=</span>values, <span class="dt">group=</span>params), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="STAT-5413_files/figure-html/unnamed-chunk-6-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>We can think of each of the <span class="math inline">\(k\)</span> iterations as a time step and can use methods from time series to examine the estimates. For example, the ACF for each parameter is</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="fitting-the-model.html#cb7-1"></a><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>))</span>
<span id="cb7-2"><a href="fitting-the-model.html#cb7-2"></a><span class="kw">acf</span>(samples[,<span class="st">&quot;mu&quot;</span>])</span>
<span id="cb7-3"><a href="fitting-the-model.html#cb7-3"></a><span class="kw">pacf</span>(samples[, <span class="st">&quot;mu&quot;</span>])</span>
<span id="cb7-4"><a href="fitting-the-model.html#cb7-4"></a><span class="kw">acf</span>(samples[,<span class="st">&quot;beta&quot;</span>])</span>
<span id="cb7-5"><a href="fitting-the-model.html#cb7-5"></a><span class="kw">pacf</span>(samples[, <span class="st">&quot;beta&quot;</span>])</span>
<span id="cb7-6"><a href="fitting-the-model.html#cb7-6"></a><span class="kw">acf</span>(samples[,<span class="st">&quot;sigma2&quot;</span>])</span>
<span id="cb7-7"><a href="fitting-the-model.html#cb7-7"></a><span class="kw">pacf</span>(samples[, <span class="st">&quot;sigma2&quot;</span>])</span></code></pre></div>
<p><img src="STAT-5413_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>We can also ask what is the effective sample size from our estimates (the equivalent sample size of uncorrelated samples)</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="fitting-the-model.html#cb8-1"></a><span class="kw">library</span>(coda)</span>
<span id="cb8-2"><a href="fitting-the-model.html#cb8-2"></a><span class="kw">effectiveSize</span>(samples)</span></code></pre></div>
<pre><code>##     mu   beta sigma2 
##  449.7  427.7 4000.0</code></pre>
<p>Because the samples of <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\beta\)</span>, and <span class="math inline">\(\sigma^2\)</span> obtained from the Gibbs sampler are from probability distributions, we can calculate any quantity of interest directly. For example, the estimate for the mean of the parameters is simply the mean of the MCMC samples</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="fitting-the-model.html#cb10-1"></a><span class="kw">colMeans</span>(samples)</span>
<span id="cb10-2"><a href="fitting-the-model.html#cb10-2"></a><span class="kw">apply</span>(samples, <span class="dv">2</span>, sd)</span>
<span id="cb10-3"><a href="fitting-the-model.html#cb10-3"></a><span class="kw">apply</span>(samples, <span class="dv">2</span>, quantile, <span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##       mu     beta   sigma2 
## -0.36411  0.41601  0.04331 
##       mu     beta   sigma2 
## 0.040486 0.009816 0.005055 
##            mu   beta  sigma2
## 2.5%  -0.4438 0.3972 0.03459
## 97.5% -0.2859 0.4357 0.05456</code></pre>
<p>and we can compare these estimates to those from the MLE</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="fitting-the-model.html#cb12-1"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -0.565 -0.124 -0.019  0.133  0.643 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.36308    0.03976   -9.13  4.7e-16 ***
## x            0.41576    0.00958   43.39  &lt; 2e-16 ***
## ---
## Signif. codes:  
## 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.206 on 148 degrees of freedom
## Multiple R-squared:  0.927,  Adjusted R-squared:  0.927 
## F-statistic: 1.88e+03 on 1 and 148 DF,  p-value: &lt;2e-16</code></pre>
<p>and the 95% credible interval for each parameter is simply the 2.5% and 97.5% quantiles of the samples.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="fitting-the-model.html#cb14-1"></a><span class="kw">apply</span>(samples, <span class="dv">2</span>, quantile, <span class="dt">prob=</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##            mu   beta  sigma2
## 2.5%  -0.4438 0.3972 0.03459
## 97.5% -0.2859 0.4357 0.05456</code></pre>
<p>We can compare these to the esimates from the MLE</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="fitting-the-model.html#cb16-1"></a><span class="kw">confint</span>(fit)</span></code></pre></div>
<pre><code>##               2.5 %  97.5 %
## (Intercept) -0.4417 -0.2845
## x            0.3968  0.4347</code></pre>
<div id="general-recommendations-for-writing-mcmc-software" class="section level3" number="13.0.1">
<h3 number="13.0.1"><span class="header-section-number">13.0.1</span> General recommendations for writing MCMC software</h3>
<ul>
<li>Have the first dimension of each object be the number of MCMC samples</li>
<li>Start with simple models and build sequentially to the complex model of interest
<ul>
<li>Example: For spatio-temporal models, first start with linear regression, then add spatial component, then add spatio-temporal model</li>
</ul></li>
<li>Find a workflow that works
<ol style="list-style-type: decimal">
<li>State the model</li>
<li>Calculate the full conditional distributions</li>
<li>Write the MCMC using a template</li>
</ol></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="example-simple-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="day-12.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["STAT-5413.pdf", "STAT-5413.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
